<!DOCTYPE html>
<html>
  <head>
    <title>Registration Page</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="../css/register.css">
    <link rel="stylesheet" href="../css/nav.css">
    <link rel="stylesheet" href="../css/searchBox.css">
  </head>
  <body>
    <header class="header">
      <nav>
        <div class="nav-container">
          <h1>网页标题</h1>
          <ul>
            <li><a href="#">首页</a></li>
            <li><a href="#">产品</a></li>
          </ul>
        </div>
        <div class="nav-container">
          <div class="searchBox">
            <input class="inputBox" placeholder="">
            <button class="searchBtn">搜索</button>
          </div>
        </div>
      </nav>
    </header>

    <form id="registerForm" method="POST">
      <div class="container">
        <h1>Register</h1>
        <p>Please fill in this form to create an account.</p>
        <hr />

        <label for="username"><b>Username</b></label>
        <input type="text" placeholder="Enter Username" name="username" required />
        <div id="usernameError" style="display: none;">Username already exists.</div>
        <label for="password"><b>Password</b></label>
        <input type="password" placeholder="Enter Password" name="password" required />
        <div id="passwordRules" style="display: none;">
          Password must contain at least 8 characters, including at least one uppercase letter, one lowercase letter, one number, and one special character.
        </div>
        <label for="confirmPassword"><b>Confirm Password</b></label>
        <input type="password" placeholder="Confirm Password" name="confirmPassword" required />
        <div id="passwordMatchError" style="display: none;">Passwords do not match.</div>
        <label for="email"><b>Email</b></label>
        <div id="error-message" style="display: none;">Please enter a valid email address.</div>
        <input type="text" id="email" placeholder="Enter Email" name="email"/>
        <div id="phoneError" style="display: none;">Please enter a valid phone number.</div>
        <label for="phoneNumber"><b>Phone Number</b></label>
        <input type="text" placeholder="Enter Phone Number" name="phoneNumber" pattern="[0-9]{11}"/>

        <label for="address"><b>Address</b></label>
        <input type="text" placeholder="Enter Address" name="address"/>

        <label for="gender"><b>Gender</b></label>
        <select name="gender">
          <option value="male">male</option>
          <option value="female">female</option>
          <option value="other">other</option>
        </select>
        
        <label for="birthday"><b>Birthday</b></label>
        <input type="date" name="birthday">

        <label for="nationality"><b>Nationality</b></label>
        <input type="text" placeholder="Enter Nationality" name="nationality"/>
        

        <hr />
        <p>By creating an account you agree to our <a href="#">Terms & Privacy</a>.</p>

        <button type="submit" class="registerbtn">Register</button>
      </div>
    </form>
    <script>
      const registerForm = document.getElementById('registerForm');
      const usernameInput = document.getElementsByName('username')[0];
      const usernameError = document.getElementById('usernameError');
      console.log(registerForm);
      usernameInput.addEventListener('blur', function() {
        const username = usernameInput.value;

        // 发送异步请求到后端验证用户名是否存在
        const xhr = new XMLHttpRequest();
        xhr.open('POST', '../php/check-username.php', true);
        xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
        xhr.onreadystatechange = function() {
          console.log(xhr);
          if (xhr.readyState == 4 && xhr.status == 200) {
            const response = JSON.parse(xhr.responseText);
            if (response.exists) {
              usernameError.style.display = 'block';
            } else {
              usernameError.style.display = 'none';
            }
          }
        };
        xhr.send('username=' + username);
      });
    </script>
  </body>
</html>